name: Deploy Maunal
on:
  push:
    branches:
      - master

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
      with:
        fetch-depth: 0

    - name: Setup mdBook
      uses: peaceiris/actions-mdbook@v1
        with:
          mdbook-version: 'latest'

    - name: Build manual
      run: mdbook build
      working-directory: manual

    - name: Deploy to GitHub Pages
      uses: JamesIves/github-pages-deploy-action@v4.2.5
      with:
        branch: gh-pages
        folder: manual/book

    #- name: Deploy GitHub Pages
      #run: |
        #cd manual
        #mdbook build
        #git worktree add gh-pages gh-pages
        #git config user.name "Deploy from CI"
        #git config user.email ""
        #cd gh-pages
        ## Delete the ref to avoid keeping history.
        #git update-ref -d refs/heads/gh-pages
        #rm -rf *
        #mv ../book/* .
        #git add .
        #git commit -m "Deploy $GITHUB_SHA to gh-pages"
        #git push --force
